<html>
<head>
  <script src="/lodash.js"></script>
  <script src="/uuid.js"></script>
  <script src="/expose.js"></script>
  <script>
    console.log("starting");

    var expose = ExposeClient();

    expose.expose("test", function(x){
      return x*x;
    })

    expose.start("localhost", 8080)



    expose.withServerApi(function(server){


      server.inverse(0).onComplete(function(retval, err){
        console.log(retval);
        console.log(err);
      });

      var future = server.inverse(5)
      future.onComplete(function(retval, err){
        console.log(retval);
        console.log(err);
      });
      setTimeout(function(){
        future.onComplete(function(retval, err){
          console.log(retval);
          console.log(err);
        });
      }, 1000);

      server.inverse(0)

    });


    setTimeout(function(){
      expose.withServerApi(function(server){
        server.test(1,2,function(){}).onComplete(function(ret,err){
          console.log("blah");
          console.log(ret);
          console.log(err);
        });

      });
    }, 5000);
  </script>
</head>
<body>
  <h1>Check the console!</h1>
</body>

</html>
